{% extends "base.html" %}

{% block title %}Recuperar Contraseña{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='css/forgot_password.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="forgot-password-container">
    <div class="forgot-password-card">
        <!-- Header -->
        <div class="forgot-password-header">
            <div class="forgot-password-icon">
                <i class="fas fa-key"></i>
            </div>
            <h1 class="forgot-password-title">Recuperar Contraseña</h1>
            <p class="forgot-password-subtitle">Ingresa tu usuario y nueva contraseña</p>
        </div>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert" 
                 {% if category == 'success' %}data-redirect="{{ url_for('auth.login') }}"{% endif %}>
                <i class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'danger' %}exclamation-triangle{% else %}info-circle{% endif %} me-2"></i>
                {{ message }}
                {% if category != 'success' %}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}
        {% endwith %}

        <!-- Form -->
        <form method="POST" class="needs-validation" novalidate id="forgotPasswordForm">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="username" name="username" placeholder="Usuario" required>
                <label for="username">
                    <i class="fas fa-user me-2"></i>Usuario
                </label>
                <div class="invalid-feedback">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    Por favor ingrese su usuario.
                </div>
            </div>

            <div class="form-floating mb-4">
                <div class="input-group">
                    <input type="password" class="form-control" id="new_password" name="new_password" placeholder="Nueva Contraseña" required minlength="6">
                    <label for="new_password" class="visually-hidden">Nueva Contraseña</label>
                    <button class="input-group-text password-toggle" type="button" id="togglePassword">
                        <i class="fas fa-eye" id="toggleIcon"></i>
                    </button>
                </div>
                <div class="invalid-feedback">
                    <i class="fas fa-exclamation-circle me-1"></i>
                    La contraseña debe tener al menos 6 caracteres.
                </div>
                <div class="form-text">
                    <i class="fas fa-info-circle me-1"></i>
                    Mínimo 6 caracteres
                </div>
            </div>

            <button type="submit" class="btn btn-forgot-password" id="submitBtn">
                <i class="fas fa-save me-2"></i>
                Actualizar Contraseña
            </button>
        </form>

        <!-- Links -->
        <div class="forgot-password-links">
            <a href="{{ url_for('auth.login') }}">
                <i class="fas fa-arrow-left me-2"></i>
                Volver al inicio de sesión
            </a>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Forgot Password JS -->
<script src="{{ url_for('static', filename='js/forgot_password.js') }}"></script>

{% endblock %}
